{% extends "base.html" %}
{% block content %}
  <h2>All Posts</h2>
  {% for post in posts %}
    <h3><a href="{% url 'post-detail' post.pk %}">{{ post.title }}</a></h3>
    <p>{{ post.content|truncatewords:20 }}</p>
    <small>By {{ post.author }} on {{ post.created_at }}</small>
  {% endfor %}
  <a href="{% url 'post-create' %}">+ New Post</a>
{% endblock %}

<form method="get" action="{% url 'post_list' %}">
    <input type="text" name="q" placeholder="Search posts..." value="{{ request.GET.q }}">
    <button type="submit">Search</button>
</form>

{% for post in posts %}
  <h2>{{ post.title }}</h2>
  <p>{{ post.content|truncatewords:20 }}</p>
  <p>
    Tags:
    {% for tag in post.tags.all %}
      <a href="{% url 'posts_by_tag' tag.name %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
    {% empty %}
      No tags
    {% endfor %}
  </p>
{% endfor %}
